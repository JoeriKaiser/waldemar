---
const currentYear = new Date().getFullYear();

const socialLinks = [
  {
    name: "GitHub",
    url: "https://github.com/JoeriKaiser",
    icon: "M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z",
  },
  {
    name: "LinkedIn",
    url: "https://www.linkedin.com/in/joeri-kaiser",
    icon: "M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z",
  },
];

const email = "joeri.waldemar@gmail.com";
---

<footer class="footer" data-footer>
  <div class="footer-inner">
    <div class="container-center">
      <div class="footer-grid">
        <!-- Connect Section -->
        <div class="footer-section">
          <h3 class="footer-heading">Connect</h3>
          <ul class="social-list">
            {
              socialLinks.map((link) => (
                <li>
                  <a
                    href={link.url}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="social-link"
                    data-social-link
                  >
                    <span class="social-icon">
                      <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d={link.icon} />
                      </svg>
                    </span>
                    <span class="social-name">{link.name}</span>
                  </a>
                </li>
              ))
            }
          </ul>
        </div>

        <!-- Contact Section -->
        <div class="footer-section">
          <h3 class="footer-heading">Get in Touch</h3>
          <div class="contact-buttons">
            <a href={`mailto:${email}`} class="contact-btn">
              <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                ></path>
              </svg>
              Email me
            </a>
            <button id="copy-email" class="contact-btn">
              <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"
                ></path>
              </svg>
              Copy email
            </button>
          </div>
        </div>

        <!-- Navigation Section -->
        <div class="footer-section">
          <h3 class="footer-heading">Navigation</h3>
          <ul class="nav-list">
            <li><a href="/" class="nav-link">Home</a></li>
            <li><a href="/#projects-list-start" class="nav-link">Projects</a></li>
            <li><a href="/about" class="nav-link">About</a></li>
            <li>
              <button id="back-to-top" class="nav-link back-to-top">
                Back to top
                <svg
                  width="12"
                  height="12"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M12 19V5M5 12l7-7 7 7"></path>
                </svg>
              </button>
            </li>
          </ul>
        </div>
      </div>

      <!-- Bottom bar -->
      <div class="footer-bottom">
        <p class="copyright">
          Made with care by Joeri Kaiser &copy; {currentYear}
        </p>

        <div class="built-with">
          <span>Crafted with</span>
          <span class="tech-rotator" data-tech-rotator>
            <span class="tech-current" data-tech-current>Astro</span>
            <span class="tech-next" data-tech-next>GSAP</span>
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast notification -->
  <div id="footer-toast" class="toast">Email copied to clipboard!</div>
</footer>

<script>
  import { gsap } from "gsap";

  document.addEventListener("astro:page-load", () => {
    const copyBtn = document.getElementById("copy-email");
    const backBtn = document.getElementById("back-to-top");
    const toast = document.getElementById("footer-toast");
    const prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;

    const showToast = () => {
      if (!toast) return;
      toast.classList.add("is-visible");

      setTimeout(() => {
        toast.classList.remove("is-visible");
      }, 2000);
    };

    copyBtn?.addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText("joeri.waldemar@gmail.com");
        showToast();
      } catch (err) {
        console.error("Failed to copy email:", err);
      }
    });

    backBtn?.addEventListener("click", () => {
      window.scrollTo({
        top: 0,
        behavior: prefersReduced ? "auto" : "smooth",
      });
    });

    // Tech rotator animation
    if (!prefersReduced) {
      const rotator = document.querySelector("[data-tech-rotator]");
      const currentSpan = document.querySelector("[data-tech-current]");
      const nextSpan = document.querySelector("[data-tech-next]");

      if (rotator && currentSpan && nextSpan) {
        const techs = ["Astro", "GSAP", "Tailwind", "care"];
        let currentIndex = 0;

        const rotateTech = () => {
          const nextIndex = (currentIndex + 1) % techs.length;

          nextSpan.textContent = techs[nextIndex];

          gsap.to(currentSpan, {
            y: -16,
            opacity: 0,
            duration: 0.5,
            ease: "power2.inOut",
          });

          gsap.fromTo(
            nextSpan,
            { y: 16, opacity: 0 },
            {
              y: 0,
              opacity: 1,
              duration: 0.5,
              ease: "power2.inOut",
              onComplete: () => {
                currentSpan.textContent = techs[nextIndex];
                gsap.set(currentSpan, { y: 0, opacity: 1 });
                gsap.set(nextSpan, { y: 16, opacity: 0 });
                currentIndex = nextIndex;
              },
            }
          );
        };

        setInterval(rotateTech, 3500);
      }
    }

    // Social link hover animation
    if (!prefersReduced) {
      const socialLinks = document.querySelectorAll("[data-social-link]");

      socialLinks.forEach((link) => {
        if (!(link instanceof HTMLElement)) return;

        link.addEventListener("mouseenter", () => {
          gsap.to(link, {
            x: 4,
            duration: 0.25,
            ease: "power2.out",
          });
        });

        link.addEventListener("mouseleave", () => {
          gsap.to(link, {
            x: 0,
            duration: 0.25,
            ease: "power2.out",
          });
        });
      });
    }
  });
</script>

<style>
  .footer {
    margin-top: var(--space-3xl);
  }

  .footer-inner {
    background: var(--wc-sand);
    border-top: 1px solid var(--wc-clay);
    padding: var(--space-xl) 0 var(--space-l);
  }

  .footer-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-l);
    margin-bottom: var(--space-xl);
  }

  @media (min-width: 768px) {
    .footer-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .footer-section {
    display: flex;
    flex-direction: column;
    gap: var(--space-s);
  }

  .footer-heading {
    font-family: var(--font-display);
    font-size: var(--text-body);
    font-weight: 600;
    color: var(--wc-ink);
    margin: 0 0 var(--space-xs) 0;
  }

  /* Social links */
  .social-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
  }

  .social-link {
    display: inline-flex;
    align-items: center;
    gap: 0.625rem;
    color: var(--wc-bark);
    text-decoration: none;
    font-size: var(--text-small);
    transition:
      color var(--duration-fast) var(--ease-smooth),
      transform var(--duration-fast) var(--ease-smooth);
  }

  .social-link:hover {
    color: var(--wc-accent);
  }

  .social-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    background: var(--wc-parchment);
    border: 1px solid var(--wc-clay);
    border-radius: var(--radius-sm);
    transition:
      border-color var(--duration-fast) var(--ease-smooth),
      background var(--duration-fast) var(--ease-smooth);
  }

  .social-link:hover .social-icon {
    border-color: var(--wc-accent);
    background: var(--wc-cream);
  }

  .icon {
    width: 16px;
    height: 16px;
    fill: currentColor;
  }

  /* Contact buttons */
  .contact-buttons {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
  }

  .contact-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.625rem 1rem;
    font-family: var(--font-body);
    font-size: var(--text-small);
    font-weight: 500;
    color: var(--wc-bark);
    background: var(--wc-parchment);
    border: 1px solid var(--wc-clay);
    border-radius: var(--radius-md);
    cursor: pointer;
    text-decoration: none;
    width: fit-content;
    transition:
      color var(--duration-fast) var(--ease-smooth),
      background var(--duration-fast) var(--ease-smooth),
      border-color var(--duration-fast) var(--ease-smooth);
  }

  .contact-btn:hover {
    color: var(--wc-accent-deep);
    background: var(--wc-cream);
    border-color: var(--wc-accent-muted);
  }

  .btn-icon {
    width: 16px;
    height: 16px;
  }

  /* Navigation */
  .nav-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
  }

  .nav-link {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    color: var(--wc-bark);
    text-decoration: none;
    font-size: var(--text-small);
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    font-family: var(--font-body);
    transition: color var(--duration-fast) var(--ease-smooth);
  }

  .nav-link:hover {
    color: var(--wc-accent);
  }

  .back-to-top {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
  }

  /* Bottom section */
  .footer-bottom {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-s);
    padding-top: var(--space-m);
    border-top: 1px dashed var(--wc-clay);
  }

  @media (min-width: 640px) {
    .footer-bottom {
      flex-direction: row;
    }
  }

  .copyright {
    font-size: var(--text-small);
    color: var(--wc-bark);
    margin: 0;
  }

  .built-with {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    font-size: var(--text-small);
    color: var(--wc-bark);
  }

  .tech-rotator {
    position: relative;
    display: inline-block;
    width: 70px;
    height: 20px;
    overflow: hidden;
  }

  .tech-current,
  .tech-next {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    font-weight: 600;
    color: var(--wc-accent);
  }

  .tech-next {
    transform: translateY(16px);
    opacity: 0;
  }

  /* Toast */
  .toast {
    position: fixed;
    left: 50%;
    transform: translateX(-50%);
    bottom: var(--space-l);
    padding: 0.75rem 1.25rem;
    background: var(--wc-cream);
    border: 1px solid var(--wc-accent);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-lg);
    font-size: var(--text-small);
    color: var(--wc-ink);
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--duration-normal) var(--ease-smooth);
    z-index: 100;
  }

  .toast.is-visible {
    opacity: 1;
    pointer-events: auto;
  }

  /* Focus states */
  button:focus-visible,
  a:focus-visible {
    outline: 2px solid var(--wc-accent);
    outline-offset: 2px;
    border-radius: var(--radius-sm);
  }
</style>
